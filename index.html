<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Kakera by dotNetTree</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
    <style type="text/css">
      .main-content h2 {
        border-bottom:1px solid #eee !important;
      }
    </style>
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Kakera</h1>
      <h2 class="project-tagline">Single-page application JS Framework</h2>
      <a href="https://github.com/dotNetTree/Kakera" class="btn">View on GitHub</a>
      <a href="https://github.com/dotNetTree/Kakera/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/dotNetTree/Kakera/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h2>
<a id="소개" class="anchor" href="#%EC%86%8C%EA%B0%9C" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>소개</h2>

<p><strong>Kakera</strong>는 Web browser에서 동작하는 JavaScript framework이며 <a href="https://en.wikipedia.org/wiki/Single-page_application">SPA(Single-page application)</a>의 원칙을 채용하였으며 현재 유행하는 SPA framework인 <a href="https://facebook.github.io/react/">React</a>처럼 MVC패턴 중 V(View)만을 담당하도록 설계되어 있다. </p>

<p><strong>Kakera</strong>의 특장점은 다음과 같다.</p>

<ol>
<li>MVC 패턴 중, View만을 담당한다.</li>
<li>보다 손쉽게 Javascript에서 <a href="https://en.wikipedia.org/wiki/Object-oriented_programming">OOP(Object-oriented programming)</a>를 활용할 수 있다.</li>
<li>Web Page의 DOM을 Component화 하기 때문에 <a href="https://en.wikipedia.org/wiki/Component-based_software_engineering">CBD(Component-Based Development)</a>가 가능해진다.</li>
<li>작성한 Component를 매우 쉽게 <a href="https://en.wikipedia.org/wiki/Composite_pattern">Composite pattern</a> 구성할 수 있으며, 재사용성이 뛰어나다.</li>
<li>AngularJS처럼 전용 모듈을 사용하지 않아도 되므로, legacy javascript code와 호환이 가능하다. 물론, IE8에서도 동작한다.</li>
<li>OOP의 개념을 숙지하고 있는 개발자라면 learning cost가 적게 든다.</li>
<li>이미 작성한 코드를 다른 SPA로의 마이그레이션이 용이하다.</li>
</ol>

<h2>
<a id="시작하기" class="anchor" href="#%EC%8B%9C%EC%9E%91%ED%95%98%EA%B8%B0" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>시작하기</h2>

<p><a href="https://github.com/dotNetTree/KakeraStaterKit/archive/master.zip">Start-Kit</a>을 받은 후 <code>app</code>폴더 밑에 hellokakera.html을 만들어보자.</p>

<pre><code>&lt;!doctype html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;meta charset="utf-8"&gt;
        &lt;title&gt;Hello Kakera~!&lt;/title&gt;
        &lt;script src="kakera/KakeraDOM.js"&gt;&lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
        &lt;div id="injectTarget"&gt;&lt;/div&gt;
        &lt;script type="text/javascript"&gt;
            var ComponentCls = KakeraDOM.createClass("Helloworld", {
                template: "&lt;h1&gt;Hello, Kakera~!&lt;/h1&gt;"
            });
            KakeraDOM.render(
                new ComponentCls(),
                document.getElementById("injectTarget")
            );
        &lt;/script&gt;
    &lt;/body&gt;
&lt;/html&gt;

</code></pre>

<p>여기에서 KakeraDOM.createClass에 의해 생성된 Function을 <strong>Component Class</strong>라 부르며 이를 활용하여 복잡하고 다양한 화면과 기능을 구현할 수 있게 된다.</p>

<h2>
<a id="튜토리얼" class="anchor" href="#%ED%8A%9C%ED%86%A0%EB%A6%AC%EC%96%BC" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>튜토리얼</h2>

<p>대략적인 Kakera 프레임워크의 흐름을 배우기 위해 간단한 튜토리얼을 해보기로 하자.
튜토리얼의 주제는 "탁상시계"이다. 이해를 돕기 위해 아래 그림을 보기로하자.</p>

<p><img src="table_clock.png" alt="table_clock"></p>

<p>우리는 이 탁상시계를 다음과 같이 분해를 할 것이다.</p>

<p><img src="table_clock2.png" alt="table_clock"></p>

<p>분해한 component structure는 다음과 같이 된다.</p>

<pre><code>TableClock
└── Display
└── BottomPannel
</code></pre>

<p>본격적인 튜토리얼에 들어가기 앞서 받은 Start-Kit의 <code>app</code>폴더에 table_clock.html을 만든 후 다음과 같이 작성한다. (만약 full-source를 먼저 보고 싶다면 <a href="#full-source">여기</a>를 클릭할 것!)</p>

<pre><code>&lt;!DOCTYPE HTML&gt;
&lt;html lang="ko"&gt;
&lt;head&gt;
&lt;title&gt;탁상시계&lt;/title&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;
&lt;meta http-equiv="Content-Script-Type" content="text/javascript" /&gt;
&lt;meta http-equiv="Content-Style-Type" content="text/css" /&gt;
&lt;meta http-equiv="X-UA-Compatible" content="IE=9" /&gt;
&lt;meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"&gt;
&lt;link rel="stylesheet" type="text/css" href="styles/css/starter.css"&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div id="tableClock"&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<h4>
<a id="메인-컴포넌트-작성" class="anchor" href="#%EB%A9%94%EC%9D%B8-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8-%EC%9E%91%EC%84%B1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>메인 컴포넌트 작성</h4>

<p>여기에서 KakeraDOM.js를 로드하고 탁상시계 컴포넌트를 작성한 후, id가 tableClock인 div에 주입(injection)을 한다. </p>

<pre><code> ...
 &lt;div id="tableClock"&gt;&lt;/div&gt;
 &lt;script src="kakera/KakeraDOM.js"&gt;&lt;/script&gt;
 &lt;script&gt;

 // 1
 var TableClock = KakeraDOM.createClass("TableClock", {
    template:
    "&lt;div&gt;\
        탁상시계\
    &lt;/div&gt;"
 });

 // 2
 KakeraDOM.render(
    new TableClock(),
    document.getElementById("tableClock")
 );

 &lt;/script&gt;
 ...

</code></pre>

<p>1번에서 KakeraDOM.createClass로 component class를 생성하게 되는데 첫번째 argument는 <code>classAlias</code>라 부르며, composite pattern 구성과 debug시 사용된다. 두번째 argument는 <code>spec</code>이라 부르며, component class의 spec을 정의한다. 2번에서는 1번에서 생성된 TableClock class를 인스턴스화 하여 타겟(id="tableClock")에 "&lt;div&gt;탁상시계&lt;div&gt;"를 주입하게 된다.</p>

<h4>
<a id="컴포넌트-합성" class="anchor" href="#%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8-%ED%95%A9%EC%84%B1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>컴포넌트 합성</h4>

<p>이제 TableClock의 child component를 생성하여 합성을 해보자.</p>

<pre><code> ...

 // 1
 var Display = KakeraDOM.createClass("Display", {
    template:
    "&lt;div&gt;\
        디스플레이\
    &lt;/div&gt;"
 });

 // 2
 var Pannel = KakeraDOM.createClass("BottomPannel", {
    template:
    "&lt;div&gt;\
        하단패널\
    &lt;/div&gt;"
 });

 // 3
 var TableClock = KakeraDOM.createClass("TableClock", {
    deps: [Display, Pannel],
    template:
    "&lt;div&gt;\
        &lt;Display /&gt;\
        &lt;BottomPannel /&gt;\
    &lt;/div&gt;"
 });

 ...

</code></pre>

<p>1번에서 상단부에 해당하는 <code>Display</code> component class를 생성한다. 그리고, 2번에서 하단부에 해당하는 <code>BottomPannel</code> component class를 생성한다.
이번에 main component에 해당하는 TableClock에 <code>deps</code>라는 spec이 추가가 되었는데, 이는 template을 사용된 custom element가 상단에서 정의한 component class에 해당함을 정의한다. 주의해야 하는 부분은 template에 정의할 때, 반드시 component class에 해당하는 변수명이 아닌 <strong><code>classAlias</code></strong>로 해야한다.</p>

<h4>
<a id="디자인-입히기" class="anchor" href="#%EB%94%94%EC%9E%90%EC%9D%B8-%EC%9E%85%ED%9E%88%EA%B8%B0" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>디자인 입히기</h4>

<p>이미 정의해놓은 css를 활용하여 디자인을 입힌다. 이 튜토리얼은 css에 대한 튜토리얼이 아니므로 설명은 생략한다.</p>

<pre><code> ...

 var Display = KakeraDOM.createClass("Display", {
    template:
    "&lt;div class='display'&gt;\
    &lt;/div&gt;"
 });

 var Pannel = KakeraDOM.createClass("BottomPannel", {
    template:
    "&lt;div class='bottom-pannel'&gt;\
        &lt;span&gt;&lt;/span&gt;\
        &lt;ul&gt;\
            &lt;li&gt;\
                &lt;a href='javascript:void(0);'&gt;Date&lt;/a&gt;\
            &lt;/li&gt;\
            &lt;li&gt;\
                &lt;a href='javascript:void(0);'&gt;Time&lt;/a&gt;\
            &lt;/li&gt;\
        &lt;/ul&gt;\
    &lt;/div&gt;"
 });

 var TableClock = KakeraDOM.createClass("TableClock", {
    deps: [Display, Pannel],
    template:
    "&lt;div class='clock-wrap'&gt;\
        &lt;h1&gt;&lt;img src='styles/images/logo_clock.png' /&gt;&lt;/h1&gt;\
        &lt;Display /&gt;\
        &lt;BottomPannel /&gt;\
    &lt;/div&gt;"
 });

 ...

</code></pre>

<h4>
<a id="props-사용-1" class="anchor" href="#props-%EC%82%AC%EC%9A%A9-1" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>props 사용 (1)</h4>

<p>Kakera framework는 마치 facebook의 React.js처럼 props를 사용할 수 있는데,
탁상시계가 화면에 등장시 디스플레이에 initialize 문자열을 TableClock에서 설정하여 보여주도록 하자.</p>

<pre><code> ...

 var Display = KakeraDOM.createClass("Display", {
    template:
    "&lt;div class='display'&gt;\
    &lt;/div&gt;",
    willMount: function () {    // 1
        this.el.innerText = this.props.initText;
    }
 });

 ...

 var TableClock = KakeraDOM.createClass("TableClock", {
    deps: [Display, Pannel],
    template:                   // 2
    "&lt;div class='clock-wrap'&gt;\
        &lt;h1&gt;&lt;img src='styles/images/logo_clock.png' /&gt;&lt;/h1&gt;\
        &lt;Display initText='Booting...'/&gt;\
        &lt;BottomPannel /&gt;\
    &lt;/div&gt;"
 });

 ...

</code></pre>

<p>1번에서 this.props가 등장하는데 2번의 custom element의 attribute가 해당 component의 props가 된다. 그리고, 1번의 willMount function은 document에 append되기 직전에 불리우는 function이며 this.el은 template을 element화 한 객체이다.</p>

<h4>
<a id="외부-라이브러리-사용" class="anchor" href="#%EC%99%B8%EB%B6%80-%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC-%EC%82%AC%EC%9A%A9" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>외부 라이브러리 사용</h4>

<p>지금 작성하고 있는 튜토리얼은 시계이므로 1초에 한번씩 현재시간을 알려주는 tick으로 알려주는 모듈이 필요하다. 이 모듈은 이미 starter-kit에 들어있으므로 라이브러리를 추가하고 사용해보자.</p>

<pre><code> &lt;script src="kakera/KakeraDOM.js"&gt;&lt;/script&gt;
 &lt;script src="js/convenience/Ticktock.js"&gt;&lt;/script&gt; // 1
 &lt;script&gt;
 ...
 var TableClock = KakeraDOM.createClass("TableClock", {

    _tick: function (dateAndTime) {     // 2
        console.log(dateAndTime);
    },
    deps: [Display, Pannel],
    template:
    "&lt;div class='clock-wrap'&gt;\
        &lt;h1&gt;&lt;img src='styles/images/logo_clock.png' /&gt;&lt;/h1&gt;\
        &lt;Display initText='Booting...'/&gt;\
        &lt;BottomPannel /&gt;\
    &lt;/div&gt;",
    init: function () {                 // 3
        this._ticktock = new Ticktock();
        this._ticktock.start(this._tick.bind(this));
    },
    destroy: function () {              // 4
        this._ticktock.stop();
    }

 });
 ...
</code></pre>

<p>1번에서'Ticktock'이라는 외부 라이브러리 모듈을 불러온다. 이 모듈은 start function실행시 설정한 callback 으로 1초에 한번씩 date와 time을 넘겨준다. 2번은 Ticktock 모듈로부터 date와 time을 넘겨받을 callback function을 설정한다. 3번은 component class가 인스턴스화 될 때 실행되는 initialize function이다. 여기에서 Ticktock의 인스턴스를 생성하고 실행을 시킨다. 4번의 destroy는 component가 제거가 될 경우 호출되는데, ticktock을 stop 시키도록 하는 코드를 넣지 않으면 component가 제거된 후에도 계속 tick이 발생하게 된다. </p>

<blockquote>
<p><strong>Note:</strong><br>
4번의 destroy는 component의 release function에 의해 호출되므로 <strong>직접 호출해선 안된다</strong>.</p>
</blockquote>

<h4>
<a id="props-사용-2" class="anchor" href="#props-%EC%82%AC%EC%9A%A9-2" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>props 사용 (2)</h4>

<p>props 사용 (1)에서는 데이터를 다른(child) component로 전달하는 것을 하였는데 이번에는 function을 전달해보도록 하겠다. 현재 ticktock으로 부터 tick을 TableClock이 받고 있는데 이것을 Display로 전달하기 위해 다음과 같이 작업을 한다.</p>

<pre><code> ...

 var Display = KakeraDOM.createClass("Display", {
    template:
    "&lt;div class='display'&gt;\
    &lt;/div&gt;",
    init: function () {     // 1
        this._removeListener = this.props.addListener("ticktock", function (dateAndTime) {
            console.log(dateAndTime);
        }.bind(this));
    },
    willMount: function () {
        this.el.innerText = this.props.initText;
    },
    destroy: function () {  // 2
        this._removeListener();
        this._removeListener = null;
    }
 });

 ...

 var TableClock = KakeraDOM.createClass("TableClock", {

    addListener: function (type, listener) {
        this._listener[type] = this._listener[type] || [];
        this._listener[type].push(listener);

        return function () {
            this.removeListner(type, listener);
        }.bind(this);
    },
    removeListener: function (type, listener) {
        if (this._listener[type]) {
            for (var i = 0; i &lt; this._listener[type].length; i++) {
                if (this._listener[type][i] === listener) {
                    this._listener[type].splice(i, 1);
                    break;
                }
            }
        }
    },
    _tick: function (dateAndTime) {
        if (this._listener["ticktock"]) {
            for (var i = 0; i &lt; this._listener["ticktock"].length; i++) {
                this._listener["ticktock"][i](dateAndTime);
            }
        }
    },
    deps: [Display, Pannel],
    template:   // 3
    "&lt;div class='clock-wrap'&gt;\
        &lt;h1&gt;&lt;img src='styles/images/logo_clock.png' /&gt;&lt;/h1&gt;\
        &lt;Display initText='Booting...'\
                 addListener={this.addListener}/&gt;\
        &lt;BottomPannel /&gt;\
    &lt;/div&gt;",
    init: function () {
        this._listener = {};
        this._ticktock = new Ticktock();
        this._ticktock.start(this._tick.bind(this));
    },
    destroy: function () {
        this._ticktock.stop();
    }

 });
 ...
</code></pre>

<p>먼저 3번의 template을 보면 Display component에 addListener가 설정되어 있음을 알 수 있다. 자기자신(TableClock)의 무언가를 다른(자식) component로 전달 할 시에는 <code>{}</code>를 사용하면 된다. TableClock은 Display로 addListener를 전달하여 listener를 설정할 수 있도록 해주고, _tick을 수정하여 Display에서 설정된 listener로 결과를 전달 하도록 수정 하였다. 그리고, Display component가 제거될 때 listener 또한 삭제를 해줘야 하므로 2번과 같이 destroy에 removeListener를 호출 하도록 하였다.</p>

<h4>
<a id="이벤트-listener-추가" class="anchor" href="#%EC%9D%B4%EB%B2%A4%ED%8A%B8-listener-%EC%B6%94%EA%B0%80" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>이벤트 listener 추가</h4>

<p>BottomPannel에는 주황색 토글 버튼이 존재한다. 이 버튼에 이벤트를 추가해보도록 하겠다.</p>

<pre><code>...
 var Pannel = KakeraDOM.createClass("BottomPannel", {
    template:
    "&lt;div class='bottom-pannel'&gt;\
        &lt;span&gt;&lt;/span&gt;\
        &lt;ul&gt;\
            &lt;li&gt;\
                &lt;a href='javascript:void(0);'&gt;Date&lt;/a&gt;\
            &lt;/li&gt;\
            &lt;li&gt;\
                &lt;a href='javascript:void(0);'&gt;Time&lt;/a&gt;\
            &lt;/li&gt;\
        &lt;/ul&gt;\
    &lt;/div&gt;",
    listener: {     // 1
        "click span": function (e) {
            console.log('버튼이 눌렸다.');
        }
    }
 });
...
</code></pre>

<p>1번은 listener라는 component class의 spec중 하나이다. event listener를 설정할 때 사용한다. </p>

<blockquote>
<p><strong>Note:</strong><br>
listener의 key는 event명+공백+css selector 형태로 만들어야 하며 value는 envent callback function을 설정해주어야 한다.</p>
</blockquote>

<h4>
<a id="props의-사용-3" class="anchor" href="#props%EC%9D%98-%EC%82%AC%EC%9A%A9-3" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>props의 사용 (3)</h4>

<p>이번엔 BottomPannel에서 이벤트를 부모인 TableClock으로 전달해보도록 하겠다.</p>

<pre><code>...
 var Pannel = KakeraDOM.createClass("BottomPannel", {
    template:
    "&lt;div class='bottom-pannel'&gt;\
        &lt;span&gt;&lt;/span&gt;\
        &lt;ul&gt;\
            &lt;li&gt;\
                &lt;a href='javascript:void(0);'&gt;Date&lt;/a&gt;\
            &lt;/li&gt;\
            &lt;li&gt;\
                &lt;a href='javascript:void(0);'&gt;Time&lt;/a&gt;\
            &lt;/li&gt;\
        &lt;/ul&gt;\
    &lt;/div&gt;",
    listener: {                 // 1
        "click span": function (e) {
            this.props.modeToggle();
        }
    }
 });

  var TableClock = KakeraDOM.createClass("TableClock", {

    onModeToggle: function () { // 2
        console.log("토글됨!");
    },
    ...
    template:                   // 3
    "&lt;div class='clock-wrap'&gt;\
        &lt;h1&gt;&lt;img src='styles/images/logo_clock.png' /&gt;&lt;/h1&gt;\
        &lt;Display initText='Booting...'\
                 addListener={this.addListener}/&gt;\
        &lt;BottomPannel modeToggle={this.onModeToggle} /&gt;\
    &lt;/div&gt;",
    ...

 });

...
</code></pre>

<p>TableClock에 2번처럼 버튼의 이벤트를 처리할 function을 정의한 후, 3번처럼 간단히 custom element의 attribute로 전달시키고 1번과 같이 사용한다.</p>

<h4>
<a id="부모에서-자식으로-접근" class="anchor" href="#%EB%B6%80%EB%AA%A8%EC%97%90%EC%84%9C-%EC%9E%90%EC%8B%9D%EC%9C%BC%EB%A1%9C-%EC%A0%91%EA%B7%BC" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>부모에서 자식으로 접근</h4>

<p>이번엔 TableClock에서 BottomPannel에 접근하여 BottomPannel의 function을 호출해보도록 하겠다.</p>

<pre><code>...
 var Pannel = KakeraDOM.createClass("BottomPannel", {
    btnMoveTo: function (direction) {   // 1
        var elem = this.el.querySelector("span"),
            pos, to, dir;

        if (direction === "left") {
            pos = 48;
            to = 0;
            dir = -1;
        } else {
            pos = 0;
            to = 48;
            dir = 1;
        }

        var id = setInterval(frame, 5);
        function frame() {
            if (pos === to) {
                clearInterval(id);
            } else {
                pos+=dir;
                elem.style.left = pos + 'px';
            }
        }
    }
    ...

 });

  var TableClock = KakeraDOM.createClass("TableClock", {
    _mode: "time",
    onModeToggle: function () { // 2
        var bPannel = this.children("BottomPannel")[0]; // 3
        if (this._mode === "time") {
            this._mode = "date";
            bPannel.btnMoveTo("left");
        } else {
            this._mode = "time";
            bPannel.btnMoveTo("right");
        }
    },
    ...
 });

...
</code></pre>

<p>BottomPannel에서는 1번처럼 direction을 받아 버튼을 움직이는 애니메이션을 실행 할 수 있는 function을 작성한다. TableClock에서는 BottomPannel의 인스턴스에 접근하여 직접 1번에 정의한 function을 호출하도록 한다. BottomPannel가 TableClock의 자식이 되므로 this.children으로 모든 자식을 얻을 수 있으며, this.children의 argument로 classAlias를 주면 해당 classAlias의 자식 list를 얻을 수 있다. 이번 튜토리얼에서는 BottomPannel가 한개 밖에 쓰이지 않았기 때문에 0번 index를 참조하였다.</p>

<h4>
<a id="마무리" class="anchor" href="#%EB%A7%88%EB%AC%B4%EB%A6%AC" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>마무리</h4>

<p>지금까지 잘 따라왔다면 화면이 여전히 "Booting..." 이라는 문자열이 나올것이다. 이 부분을 고치기 위해 다음과 같이 코드를 수정한다.</p>

<pre><code>...
 var Display = KakeraDOM.createClass("Display", {
    template:
    "&lt;div class='display'&gt;\
    &lt;/div&gt;",
    init: function () {     // 1
        this._removeListener = this.props.addListener("ticktock", function (dateAndTime) {
            this.el.innerText = dateAndTime;
        }.bind(this));
    },
    ...
 });

...

  var TableClock = KakeraDOM.createClass("TableClock", {
    ...
    _tick: function (dateAndTime) {
        if (this._listener["ticktock"]) {
            for (var i = 0; i &lt; this._listener["ticktock"].length; i++) {
                this._listener["ticktock"][i](dateAndTime[this._mode]);// 2
            }
        }
    },
    ...
 });

...
</code></pre>

<p>이전까지는 2번에서 리스너로 Object를 넘겨주었는데 이 부분을 mode에 따라 해당하는 문자열을 넘겨주도록 수정하고, 1번처럼 리스너로 들어오는 문자열을 바로 화면에 출력시키도록 수정한다.</p>

<h4>
<a id="full-source" class="anchor" href="#full-source" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a name="full-source">full-source</a>
</h4>

<p>위 튜토리얼의 전체 소스는 다음과 같다.</p>

<pre><code>&lt;!DOCTYPE HTML&gt;
&lt;html lang="ko"&gt;
&lt;head&gt;
&lt;title&gt;탁상시계&lt;/title&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;
&lt;meta http-equiv="Content-Script-Type" content="text/javascript" /&gt;
&lt;meta http-equiv="Content-Style-Type" content="text/css" /&gt;
&lt;meta http-equiv="X-UA-Compatible" content="IE=9" /&gt;
&lt;meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"&gt;
&lt;link rel="stylesheet" type="text/css" href="styles/css/starter.css"&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div id="tableClock"&gt;&lt;/div&gt;
  &lt;script src="kakera/KakeraDOM.js"&gt;&lt;/script&gt;
  &lt;script src="js/convenience/Ticktock.js"&gt;&lt;/script&gt;

  &lt;script&gt;
  var Display = KakeraDOM.createClass("Display", {
    template:
    "&lt;div class='display'&gt;\
    &lt;/div&gt;",
    init: function () {
        this._removeListener = this.props.addListener("ticktock", function (dateAndTime) {
            this.el.innerText = dateAndTime;
        }.bind(this));
    },
    willMount: function () {
        this.el.innerText = this.props.initText;
    },
    destroy: function () {
        this._removeListener();
        this._removeListener = null;
    }
  });

  var Pannel = KakeraDOM.createClass("BottomPannel", {
    btnMoveTo: function (direction) {
        var elem = this.el.querySelector("span"),
            pos, to, dir;

        if (direction === "left") {
            pos = 48;
            to = 0;
            dir = -1;
        } else {
            pos = 0;
            to = 48;
            dir = 1;
        }

        var id = setInterval(frame, 5);
        function frame() {
            if (pos === to) {
                clearInterval(id);
            } else {
                pos+=dir;
                elem.style.left = pos + 'px';
            }
        }
    },
    template:
    "&lt;div class='bottom-pannel'&gt;\
        &lt;span&gt;&lt;/span&gt;\
        &lt;ul&gt;\
            &lt;li&gt;&lt;a href='javascript:void(0);'&gt;Date&lt;/a&gt;&lt;/li&gt;\
            &lt;li&gt;&lt;a href='javascript:void(0);'&gt;Time&lt;/a&gt;&lt;/li&gt;\
        &lt;/ul&gt;\
    &lt;/div&gt;",
    listener: {
        "click span": function (e) {
            this.props.modeToggle();
        }
    }
  });

  var TableClock = KakeraDOM.createClass("TableClock", {
    _mode: "time",
    onModeToggle: function () {
        var bPannel = this.children("BottomPannel")[0];
        if (this._mode === "time") {
            this._mode = "date";
            bPannel.btnMoveTo("left");
        } else {
            this._mode = "time";
            bPannel.btnMoveTo("right");
        }
    },
    addListener: function (type, listener) {
        this._listener[type] = this._listener[type] || [];
        this._listener[type].push(listener);

        return function () {
            this.removeListner(type, listener);
        }.bind(this);
    },
    removeListener: function (type, listener) {
        if (this._listener[type]) {
            for (var i = 0; i &lt; this._listener[type].length; i++) {
                if (this._listener[type][i] === listener) {
                    this._listener[type].splice(i, 1);
                    break;
                }
            }
        }
    },
    _tick: function (dateAndTime) {
        if (this._listener["ticktock"]) {
            for (var i = 0; i &lt; this._listener["ticktock"].length; i++) {
                this._listener["ticktock"][i](dateAndTime[this._mode]);
            }
        }
    },
    deps: [Display, Pannel],
    template:
    "&lt;div class='clock-wrap'&gt;\
        &lt;h1&gt;&lt;img src='styles/images/logo_clock.png' /&gt;&lt;/h1&gt;\
        &lt;Display initText='Booting...'\
                 addListener={this.addListener}/&gt;\
        &lt;BottomPannel modeToggle={this.onModeToggle} /&gt;\
    &lt;/div&gt;",
    init: function () {
        this._listener = {};
        this._ticktock = new Ticktock();
        this._ticktock.start(this._tick.bind(this));
    },
    destroy: function () {
        this._ticktock.stop();
    }
  });

  KakeraDOM.render(
    new TableClock(),
    document.getElementById("tableClock")
  );

  &lt;/script&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<h2>
<a id="api-문서" class="anchor" href="#api-%EB%AC%B8%EC%84%9C" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>API 문서</h2>

<p><a href="./out/KakeraDOM.html">여기 클릭</a></p>

<h2>
<a id="release-note" class="anchor" href="#release-note" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Release note</h2>

<ul>
<li>1.1.1 (16.05.30)

<ul>
<li>bugfix

<ul>
<li>removeChild 시 정상적으로 children에서 삭제되지 않는 버그 수정. </li>
</ul>
</li>
</ul>
</li>
<li>1.1.0 (16.05.09)

<ul>
<li>KakeraOriginClass

<ul>
<li>subclass function 추가. </li>
<li>multiline function deprecated 됨.</li>
</ul>
</li>
</ul>
</li>
<li>1.0.0 (16.01.13)

<ul>
<li>Kakera framework의 시작</li>
</ul>
</li>
</ul>

<h2>
<a id="copyright" class="anchor" href="#copyright" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Copyright</h2>

<p>Copyright 2015 (C) CABSOFTWARE.COM - All Rights Reserved</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/dotNetTree/Kakera">Kakera</a> is maintained by <a href="https://github.com/dotNetTree">dotNetTree</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>


  </body>
</html>
